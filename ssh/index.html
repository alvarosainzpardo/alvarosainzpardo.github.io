<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Ssh - Documentación de Alvaro</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Ssh";
    var mkdocs_page_input_path = "ssh.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Documentación de Alvaro</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Trabajo</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../smart_cities/">Smart Cities</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../uma/">Universidad de Málaga</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../fiware/">FIWARE</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../calidad_aire/">Calidad del Aire</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../video/">Video</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../espacios_digitales/">Espacios Digitales</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Personal</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="#">Hi-Fi</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../hifi/general/">General</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../hifi/lossless/">Lossless</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../hifi/linux-audiofilo/">Linux Audiofilo</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../hifi/darkvoice/">Darkvoice 336SE</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../hifi/r1-zenith/">IMR R1 Zenith</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../hifi/r2-aten/">IMR R2 Aten</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Programación</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../programming/atom/">Atom</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../programming/emmet/">Emmet</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../programming/git/">Git</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../programming/javascript/">JavaScript</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../programming/python/">Python</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Ruby</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../programming/ruby/general/">General</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../programming/ruby/rails/">Rails</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../programming/ruby/rspec/">RSpec</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../programming/vim/">Vim</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../programming/vscode/">Visual Studio Code</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Data Science</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../data_science/general/">General</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../data_science/cursos/">Cursos</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../data_science/python/">Python</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../data_science/forecasting/">Forecasting</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../data_science/nlp/">Natural Language Proccessing</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../data_science/R/">R</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">AgileVentures</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../agileventures/charity_commission_api/">Charity Commission API</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../backgammon/">Backgammon</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../detailing/">Detailing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../docker/">Docker</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../geojson/">GeoJSON</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../brew/">Homebrew</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../markdown/">Markdown</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../mysql/">MySQL</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../putty/">PuTTY</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../robocopy/">Robocopy</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Ssh</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#enlaces-documentacion">Enlaces, documentación</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#usar-ssh-detras-de-un-proxy">Usar ssh detrás de un proxy</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#nc-en-mac-osx">nc en Mac OSX</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#autenticacion-con-clave-privada-archivos-pem">Autenticación con clave privada (archivos .pem)</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#configuracion-del-cliente">Configuración del cliente</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#configuracion-del-servidor">Configuración del servidor</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../tmux/">Tmux</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ubuntu/">Ubuntu</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../windows10/">Windows 10</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Documentación de Alvaro</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Personal &raquo;</li>
        
      
    
    <li>Ssh</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="guia-rapida-de-ssh">Guia rápida de ssh</h1>
<hr />
<h2 id="enlaces-documentacion">Enlaces, documentación</h2>
<ul>
<li><a href="http://www.perkin.org.uk/posts/ssh-via-http-proxy-in-osx.html">SSH via HTTP proxy in OSX</a></li>
<li><a href="https://stackoverflow.com/questions/19161960/connect-with-ssh-through-a-proxy">Connect with SSH through a proxy</a></li>
<li><a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AccessingInstancesLinux.html">Connecting to Your Linux Instance Using SSH</a></li>
</ul>
<hr />
<h2 id="usar-ssh-detras-de-un-proxy">Usar ssh detrás de un proxy</h2>
<p>El comando para realizar una conexión ssh a través de un servidor proxy es:</p>
<pre><code class="bash">$ ssh &lt;user&gt;@&lt;host&gt; -o &quot;ProxyCommand=nc -X connect -x &lt;proxyhost&gt;:&lt;proxyport&gt; %h %p&quot;
</code></pre>

<p>Por ejemplo:</p>
<pre><code class="bash">$ ssh asainz@sulaco.ttcloud.net -o &quot;ProxyCommand=nc -X connect -x proxyinternet.tesa:8080 %h %p&quot;
</code></pre>

<p>Para que este comando funcione, el servidor proxy tiene que aceptar el método de conexión <code>CONNECT</code> y el comando <code>nc</code> tiene que estar instalado en el sistema.</p>
<p>Para usar un proxy socks5 el comando es:</p>
<pre><code class="bash">$ ssh &lt;user&gt;@&lt;host&gt; -o &quot;ProxyCommand=nc -X 5 -x &lt;proxyhost&gt;:&lt;proxyport&gt; %h %p&quot;
</code></pre>

<p>Y para usar un proxy socks4 se utilizaría la opción <code>-X 4</code>.</p>
<p>Para no tener que teclear el comando cada vez que se utiliza el cliente ssh se puede configurar esta opción en el archivo de configuración de ssh, <code>~/.ssh/config</code>.</p>
<p>Se puede añadir la opción para todos los hosts:</p>
<pre><code>Host *
    ProxyCommand          nc -X connect -x proxyhost:proxyport %h %p
    ServerAliveInterval   10
</code></pre>
<p>O para un host en concreto:</p>
<pre><code>Host sulaco.ttcloud.net
    ProxyCommand          nc -X connect -x proxyhost:proxyport %h %p
    ServerAliveInterval   10
</code></pre>
<p>La opción <code>ServerAliveInterval</code>es para que el proxy no desconecte después de un periodo de inactividad.</p>
<h3 id="nc-en-mac-osx">nc en Mac OSX</h3>
<p>La versión de nc de OSX tiene un problema de compatibilidad con los proxies http. No es compatible con proxies que utilizan HTTP 1.1, sólo es compatible con HTTP 1.0. El proxy de Telefónica utiliza HTTP 1.1, por lo que no se puede usar nc. Una alternativa que funciona perfectamente es <a href="https://nmap.org/ncat/">ncat</a>, que forma parte del paquete <a href="https://nmap.org/">nmap</a>.</p>
<p>La opción para utilizar ncat en el archivo <code>~/.ssh/config</code> es:</p>
<pre><code>Host *
    ProxyCommand          ncat --proxy proxyhost:proxyport --proxy-auth user:passwd %h %p
</code></pre>
<hr />
<h2 id="autenticacion-con-clave-privada-archivos-pem">Autenticación con clave privada (archivos .pem)</h2>
<p>Para conectarse a máquinas virtuales de Amazon y Fiware, hay que utilizar la autenticación con clave privada (archivos .pem)</p>
<h3 id="configuracion-del-cliente">Configuración del cliente</h3>
<ul>
<li><a href="https://michaelheap.com/ssh-config-files/">SSH Config Files</a></li>
</ul>
<p>La opción para conectarse a un servidor que requiere autenticación por clave privada es <code>-i &lt;archivo.pem&gt;</code>:</p>
<pre><code class="bash">$ ssh &lt;user&gt;@&lt;host&gt; -i &lt;path/file.pem&gt;
</code></pre>

<p>El archivo .pem tiene que tener permisos de lectura únicamente para el propietario del archivo (<code>chmod 400 &lt;archivo.pem&gt;</code>).</p>
<p>La configuracíón equivalente en el archivo <code>~/.ssh/config</code>sería:</p>
<pre><code>Host &lt;host&gt;
    IdentityFile &lt;path/file.pem&gt;
</code></pre>
<h3 id="configuracion-del-servidor">Configuración del servidor</h3>
<p>Cuando el servidor ssh está configurado para aceptar únicamente conexiones sin password mediante clave privada, en el directorio <code>.ssh</code> del usuario hay que copiar el archivo <code>authorized_keys</code> que se haya generado para el usuario por defecto de la maquina virtual.</p>
<p>El directorio <code>.ssh</code> tiene que tener permisos de lectura/escritura/ejecución sólo para el propietario (<code>chmod 700 ~/.ssh</code>) y el archivo <code>authorized_keys</code> permisos de lectura/escritura únicamente para el propietario (<code>chmod 600 ~/.ssh/authorized_keys</code>).</p>
<p>Además, hay que comprobar que el el archivo de configuración del servidor sshd (<code>/etc/ssh/sshd_config</code>) esté autorizado el acceso por ssh para el nuevo usuario. Esto hay que hacerlo <strong>obligatoriamente en las máquinas virtuales Ubuntu de Fiware</strong>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tmux/" class="btn btn-neutral float-right" title="Tmux">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../robocopy/" class="btn btn-neutral" title="Robocopy"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../robocopy/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../tmux/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
